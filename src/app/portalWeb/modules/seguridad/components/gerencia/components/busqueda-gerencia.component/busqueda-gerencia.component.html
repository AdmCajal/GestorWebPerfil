<section class="card">
    <app-cabecera-vista [componente]="this"></app-cabecera-vista>

    <form class="flex flex-wrap" [formGroup]="filtroForm" (ngSubmit)="btnBuscar()">
        <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-12 ">
            <label for="name1">Compañia</label>
            <p-select [options]="lstCompania" optionLabel="descripcion" optionValue="codigo" formControlName="ESTADO"
                placeholder="Seleccione una opción" (onChange)="btnObtenerSucursal($event)"></p-select>
        </div>
        <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-12 ">
            <label for="name1">Sucursal</label>
            <p-select [options]="lstSucursal" optionLabel="descripcion" optionValue="codigo" formControlName="ESTADO"
                placeholder="Seleccione una opción"></p-select>
        </div>
        <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-6 ">
            <label for="name1">Gerencia</label>
            <input pInputText id="name1" type="text" formControlName="USUARIO"
                placeholder="Ingrese nombre de gerencia" />
        </div>
        <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-12 ">
            <label for="name1">Gerente</label>
            <p-select [options]="lstEstado" optionLabel="descripcion" optionValue="codigo" formControlName="ESTADO"
                placeholder="Seleccione una opción"></p-select>
        </div>
        <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-12 ">
            <label for="name1">Responsable</label>
            <p-select [options]="lstEstado" optionLabel="descripcion" optionValue="codigo" formControlName="ESTADO"
                placeholder="Seleccione una opción"></p-select>
        </div>
        <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-12 ">
            <label for="name1">Estado</label>
            <p-select [options]="lstEstado" optionLabel="descripcion" optionValue="codigo" formControlName="ESTADO"
                placeholder="Seleccione una opción"></p-select>
        </div>
        <!-- <div class="flex flex-col gap-2 pl-2 pr-2 md:col-3 col-12 ">
            <label for="name1">Fecha Creación</label>
            <p-datepicker formControlName="rangoFechaCreacion" [styleClass]="'col-12 p-0'" [iconDisplay]="'input'"
                [showIcon]="true" inputId="icondisplay" selectionMode="range" />
        </div> -->
    </form>
</section>

<section class="card">
    <p-table #dt1 [value]="lstDataBusqueda" [tableStyle]="{'min-width': '40rem', 'max-heigth': '50vh'}"
        [selectionPageOnly]="false" [paginator]="true" [rows]="cntRegistros" [showCurrentPageReport]="true"
        [tableStyle]="{ 'min-width': '50rem' }" [rowHover]="true" [paginator]="true" selectionMode="single"
        currentPageReportTemplate="Mostrando {first} - {last} de {totalRecords} registros" responsiveLayout="scroll"
        [showCurrentPageReport]="true" [rowsPerPageOptions]="[ 5,10, 25, 50]">
        <ng-template #caption>
            <div class="flex">
                <p class="text-align-center mb-0 text-xl font-semibold flex align-items-end">Resultados de Búsqueda:</p>
            </div>
        </ng-template>
        <ng-template #header>
            <tr>
                <th class="w-1">Acciones</th>
                <th>Compañia</th>
                <th>Descripción</th>
                <th>Gerente</th>
                <th>Estado</th>
            </tr>
        </ng-template>
        <ng-template #body let-data>
            <tr>
                <td class="flex flex-nowrap gap-2">
                    <p-button title="Ver Registro" icon="pi pi-eye" severity="info" rounded outlined
                        (onClick)="btnMantenimientoFormulario(AccionFormulario.VER,data)" />
                    <p-button title="Editar Registro" icon="pi pi-pencil" rounded outlined
                        styleClass="border-yellow-500 text-yellow-500"
                        (onClick)="btnMantenimientoFormulario(AccionFormulario.EDITAR, data)" />
                    <p-button title="{{obtenerDescAccionEstado(data.estado)}} Registro"
                        icon="pi {{obtenerIconoAccionEstado(data.estado)}}"
                        [severity]="obtenerColorAccionEstado(data.estado)" rounded outlined
                        (onClick)="btnInactivarRegistro($event, data)" />
                </td>
                <td> {{data.nombreAplicativo | titlecase}}</td>
                <td>{{data.descripcion | titlecase}}</td>
                <td>{{data.baseDatos }}</td>
                <td [style]="{'white-space':'nowrap'}">
                    <p-tag [icon]="'pi ' + obtenerIconoEstado(data.estado)"
                        [severity]="obtenerColorEstado(data.estado) || 'info'" [value]="data.estadoDesc">
                    </p-tag>
                </td>

            </tr>
        </ng-template>
        <ng-template #emptymessage>
            <tr>
                <td colspan="8">No se encontró información.</td>
            </tr>
        </ng-template>
        <ng-template #loadingbody>
            <tr>
                <td colspan="8">Cargando información. Espere por favor...</td>
            </tr>
        </ng-template>
    </p-table>
</section>
<app-mantenimiento-gerencia (msjMantenimiento)="rptaMantenimiento($event)"></app-mantenimiento-gerencia>
<p-toast [showTransformOptions]="'translateY(90%)'" key="notification" position="bottom-right"></p-toast>