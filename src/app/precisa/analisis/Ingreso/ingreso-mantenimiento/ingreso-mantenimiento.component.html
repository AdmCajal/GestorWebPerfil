<p-blockUI [blocked]="bloquearPag" [baseZIndex]="10000">
    <img src="assets\img\ZZ5H.gif" style="width: 5%">
</p-blockUI>
<p-dialog [(visible)]="dialog" [draggable]="false" [modal]="true" [resizable]="false" [breakpoints]="{'950px': '75vw'}"
    [style]="{width: '1150px'}" [header]="acciones" [position]="position" [maximizable]="true" [baseZIndex]="1000">
    <br>
    <ng-template pTemplate="content">
        <div class="row">
            <div class="col-sm-7">
                <p-fieldset legend="Comprobante">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="label">Tipo de Comprobante:</label>
                                        <div class="p-inputgroup">
                                            <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                            <p-dropdown [disabled]="puedeEditar" [options]="lstTipoComprobante"
                                            [style]="{'background-color':'rgb(247, 247, 208)', 'width':'100%'}" 
                                                class="tablaCompletaIzquieda" [(ngModel)]="contrato.TipoComprobante" >
                                            </p-dropdown>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group">
                                        <label class="label">Serie:</label>
                                        <div class="p-inputgroup">
                                            <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                            <p-dropdown [disabled]="puedeEditar" [options]="lstSerie"
                                            [style]="{'background-color':'rgb(247, 247, 208)', 'width':'100%'}"
                                                class="tablaCompletaIzquieda" [(ngModel)]="contrato.SerieComprobante" >
                                            </p-dropdown>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <label class="label">Nro Comprobante</label>
                                        </div>
                                        <div class="col-sm-12">
                                            <input [readOnly]="true" pInputText type="text" style="width:100%;"
                                                [disabled]="true"  [(ngModel)]="contrato.NumeroComprobante"  
                                                class="hoverDisabled size-large status-basic shape-rectangle nb-transition" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <label class="label">Fecha de Emisi√≥n:</label>
                                        </div>
                                        <div class="col-sm-12">
                                            <p-calendar [monthNavigator]="true" [yearNavigator]="true"
                                                [disabled]="true" [style]="{'width':'100%'}"
                                                [(ngModel)]="contrato.FechaEmision" [inputStyle]="{'width':'100%'}"
                                                yearRange="1940:2300" [locale]="es" dateFormat="dd/mm/yy"
                                                [showIcon]="true">
                                            </p-calendar>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <label class="label">Cliente</label>
                                </div>
                                <div class="col-sm-12">
                                    <input [readOnly]="true" pInputText type="text"
                                        class="hoverDisabled size-large status-basic shape-rectangle nb-transition"
                                        style="width:100%;" [(ngModel)]="contrato.Cliente" [disabled]="puedeEditar" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Moneda:</label>
                                        <div class="p-inputgroup">
                                            <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                            <p-dropdown [disabled]="puedeEditar" [options]="lstMoneda"
                                            [style]="{'background-color':'rgb(247, 247, 208)', 'width':'100%'}"
                                                class="tablaCompletaIzquieda" [(ngModel)]="contrato.MonedaCodigo">
                                            </p-dropdown>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Cambio:</label>
                                        <div class="p-inputgroup">
                                            <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                            <p-inputNumber mode="decimal" [(ngModel)]="contrato.TipoCambio"
                                                [inputStyle]="{'width':'100%','text-align': 'right'}"
                                                [maxFractionDigits]="2" [disabled]="true" [minFractionDigits]="2">
                                            </p-inputNumber>
                                           
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <label class="label">Monto:</label>
                                        <div class="p-inputgroup">
                                            <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                            <p-inputNumber mode="decimal" [(ngModel)]="contrato.MontoTotal"
                                            [inputStyle]="{'width':'100%','text-align': 'right'}"
                                            [maxFractionDigits]="2" [disabled]="true" [minFractionDigits]="2">
                                        </p-inputNumber>                                                                                  </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </p-fieldset>
            </div>  
            <div class="col-sm-5">  
                <p-fieldset legend="Pago">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="label">Forma de Pago</label>
                                            <div class="p-inputgroup">
                                                <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                                <p-dropdown [disabled]="puedeEditar" class="tablaCompletaIzquieda"
                                                    [options]="lstTipoPago" (click)="validarTipoPago()"
                                                    [(ngModel)]="contrato.FormaPago"
                                                    [style]="{'background-color':'rgb(247, 247, 208)', 'width':'100%'}"> </p-dropdown>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="label">Banco</label>
                                            <div class="p-inputgroup">
                                                <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                                <p-dropdown [disabled]="puedeEditar" class="tablaCompletaIzquieda"
                                                    [options]="lstBanco" [(ngModel)]="contrato.BancoFactoring"
                                                    (onChange)="cuentaBancaria()"
                                                    [style]="{'width':'100%','text-transform': 'uppercase'}"></p-dropdown>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="label">Cuenta Bancaria</label>
                                            <div class="p-inputgroup">
                                                <span class="p-inputgroup-addon"><i class="pi pi-align-justify"></i></span>
                                                <p-dropdown [disabled]="puedeEditar" class="tablaCompletaIzquieda"
                                                [disabled]="puedeEditar" [options]="lstcuentaBancaria"
                                                    [(ngModel)]="contrato.CuentaBancaria"
                                                    [style]="{'width':'100%','text-transform': 'uppercase'}"> </p-dropdown>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="form-group">
                                            <label class="label">Referencia</label>
                                            <div class="p-inputgroup">
                                                <input pInputText type="text" style="width:100%;"
                                                    [(ngModel)]="contrato.CampoReferencia" [disabled]="puedeEditar"
                                                    class="hoverDisabled size-large status-basic shape-rectangle nb-transition" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <div class="form-group">
                                            <label class="label">Observaci√≥n</label>
                                            <div class="p-inputgroup">
                                                <textarea pInputText type="text" [disabled]="puedeEditar" pInputTextarea rows="3" cols="20"
                                                    [(ngModel)]="contrato.Observacion"
                                                    [style]="{'width':'100%','text-transform': 'uppercase'}"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                        </div>  
                    </div>
                </p-fieldset>
            </div>
                     <div class="col-sm-12">
                        <p-fieldset legend="Detalle">
        
                            <p-table #dt [rows]="15" [paginator]="false" [rowHover]="true" dataKey="num" [value]="lstLetra"
                                [responsive]="true" [sortOrder]="1" sortField="num" [scrollable]="true">
        
                                <ng-template pTemplate="header">
                                    <tr>                                    
                                        <th pSortableColumn="FechaVencimiento" class="label" ALIGN="center"
                                            style="width: 5rem; text-align: center">
                                            Fecha <p-sortIcon field="FechaVencimiento"></p-sortIcon>
                                        </th>
                                        <th pSortableColumn="Nombre" class="label" ALIGN="center"
                                            style="width: 5rem; text-align: center">
                                            Detalle<p-sortIcon field="Nombre"></p-sortIcon>
                                        </th>
                                        <th class="label" pSortableColumn="MontoTotal" ALIGN="center"
                                            style="width: 5rem; text-align: center;">
                                            Monto<p-sortIcon field="MontoTotal"></p-sortIcon>
                                        </th>
                                       
                                    </tr>
                                </ng-template>
                                <ng-template pTemplate="body" let-rowData>
                                    <tr>                                       
                                        <td class="tablaColumnaCodigoChico text-center" style="width: 5rem;">
                                            <span class="p-column-title">Fecha</span>
                                            {{ rowData.FechaVencimiento | date : "dd/MM/yyyy" }}
                                        </td>
                                        <td class="tablaColumnaCodigoChico text-center" ALIGN="center" style="width: 5rem;">
                                            <span class="p-column-title">Detalle</span>
                                            {{ rowData.Nombre }}
                                        </td>
                                        <td class="tablaColumnaCodigoChico text-center" ALIGN="center" style="width: 5rem;">
                                            <span class="p-column-title">Monto</span>
                                            {{ rowData.MontoTotal | number:'1.2-2'}}
                                        </td>
                                       
                                    </tr>
                                </ng-template>
                            </p-table>
                        </p-fieldset>
                    </div>           
        </div>     
    </ng-template>
    <ng-template pTemplate="footer">
        <p-button label="Pagar" icon="pi pi-save" styleClass="p-button-primary" *ngIf="!puedeEditar" [disabled]="puedeEditar" type="submit"
            (click)="corepagar()"></p-button>
        <p-button label="Imprimir" icon="pi pi-file-pdf" styleClass="p-button-primary" *ngIf="!puedeEditar"  [disabled]="puedeEditar"
            type="submit"></p-button>
    </ng-template>
</p-dialog>